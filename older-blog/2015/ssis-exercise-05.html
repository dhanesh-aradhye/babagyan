
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="">
	<link rel="author" href="https://plus.google.com/103656420801452265269"/>
	<link rel="publisher" href="https://plus.google.com/113497864022889042631"/>

	<title>SSIS Exercise 05 | BabaGyan.com | Blog</title>
    <meta name="description" content="SSIS Exercise 05 MSBI"/>

	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:site" content="@baba_gyan"/>
	<meta name="twitter:domain" content="BabaGyan"/>
	<meta name="twitter:creator" content="@baba_gyan"/>
	
    <!-- Bootstrap core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../css/babagyan.css" rel="stylesheet">


    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	
	
<script type="application/javascript">  <script type="text/javascript">  if (window.top !== window.self) { window.top.location = window.self.location; } </script> <script type="application/javascript"> var doNotTrack = false; if (!doNotTrack) { window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;	 ga('create', 'UA-155045464-2', 'auto'); ga('send', 'pageview');} </script> <script async src='https://www.google-analytics.com/analytics.js'></script> </head>

  <body>

    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation"	>
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><< - Back to NEW Home</a>
        </div>
        
      </div>
    </div>


    <div class="container">

<!-- Container 1 start -->
<div class="container col-md-8">

<!-- Jumbotron 1 start -->

<div class="jumbotron" id="j1">
	<h3>SSIS Exercise 05
	</h3>
	<hr id="j1-hr">
SSIS Exercise 05
<br/><br/>
Modify ETL Package Control Flow
<br/>
This exercise will allow us to start the process of building the DimCustomer SSIS package that will handle the ETL process from the AdventureWorks2008 database to the AdventureWorks-DW2008 database.
<br/>
Start SQL Server Business Intelligence Development Studio (BIDS), open the project SSIS Project you created in last exercise here and then open the empty DimCustomer package.
<br/>
<a href="017.jpg"><img class="alignnone size-medium wp-image-300" alt="01" src="017.jpg" width="300" height="138" /></a>
<br/><br/>
From the toolbox, drag two Execute SQL Tasks onto the control flow workspace and then drag one Data Flow Task onto the workspace.
<br/>
<a href="025.jpg"><img class="alignnone size-medium wp-image-301" alt="02" src="025.jpg" width="300" height="217" /></a>
<br/><br/>
Now, connect the first Execute SQL Task to the Data Flow Task by dragging the green precedence constraint from the Execute SQL Task onto the Data Flow Task.
<br/>
<a href="036.jpg"><img class="alignnone size-medium wp-image-302" alt="03" src="036.jpg" width="300" height="248" /></a>
<br/><br/>
Then connect the green precedence constraint from the Data Flow Task to the second Execute SQL Task.
<br/>
<a href="043.jpg"><img class="alignnone size-medium wp-image-303" alt="04" src="043.jpg" width="300" height="248" /></a>
<br/><br/>
Rename the first Execute SQL Task to Truncate Update Table, and rename the second Execute SQL Task to Batch Updates.
<br/>
<a href="053.jpg"><img class="alignnone size-medium wp-image-304" alt="05" src="053.jpg" width="300" height="247" /></a>
<br/><br/>
Now, open SSMS, connect to the Database Engine, and create a new query against the AdventureWorksDW2008R2 database. Execute the following code
<br/>
<blockquote>USE AdventureWorksDW2008R2
<br/>GO
<br/>CREATE TABLE [dbo].[stgDimCustomerUpdates](
<br/>[CustomerAlternateKey] [nvarchar](15) NULL,
<br/>[AddressLine1] [nvarchar](60) NULL,
<br/>[AddressLine2] [nvarchar](60) NULL,
<br/>[BirthDate] [datetime] NULL,
<br/>[CommuteDistance] [nvarchar](15) NULL,
<br/>[DateFirstPurchase] [datetime] NULL,
<br/>[EmailAddress] [nvarchar](50) NULL,
<br/>[EnglishEducation] [nvarchar](40) NULL,
<br/>[EnglishOccupation] [nvarchar](100) NULL,
<br/>[FirstName] [nvarchar](50) NULL,
<br/>[Gender] [nvarchar](1) NULL,
<br/>[GeographyKey] [int] NULL,
<br/>[HouseOwnerFlag] [nvarchar](1) NULL,
<br/>[LastName] [nvarchar](50) NULL,
<br/>[MaritalStatus] [nvarchar](1) NULL,
<br/>[MiddleName] [nvarchar](50) NULL,
<br/>[NumberCarsOwned] [tinyint] NULL,
<br/>[NumberChildrenAtHome] [tinyint] NULL,
<br/>[Phone] [nvarchar](25) NULL,
<br/>[Suffix] [nvarchar](10) NULL,
<br/>[Title] [nvarchar](8) NULL,
<br/>[TotalChildren] [tinyint] NULL,
<br/>[YearlyIncome] [nvarchar](100) NULL) ON [PRIMARY]</blockquote>
<br/>
<a href="063.jpg"><img class="alignnone size-medium wp-image-305" alt="06" src="063.jpg" width="300" height="155" /></a>
<br/><br/>
After the table is created, switch back to the DimCustomer SSIS package and edit the Execute SQL Task named Truncate Update Table.
<br/>
In the Execute SQL Task Editor dialog box, set the Connection property to Adventure-WorksDW2008R2, and then enter the following SQL code in the SQLStatement property
<br/>
<blockquote>TRUNCATE TABLE dbo.stgDimCustomerUpdates</blockquote>
<br/>
Click OK to save it
<br/>
<a href="073.jpg"><img class="alignnone size-medium wp-image-306" alt="07" src="073.jpg" width="300" height="256" /></a>
<br/><br/>
Edit the last Execute SQL Task, named Batch Updates, and set the Connection property to AdventureWorksDW2008R2
<br/>
In the SQLStatement property, enter the following UPDATE statement:
<br/>
<blockquote>UPDATE dbo.DimCustomer
<br/>SET AddressLine1 = stgDimCustomerUpdates.AddressLine1
<br/>, AddressLine2 = stgDimCustomerUpdates.AddressLine2
<br/>, BirthDate = stgDimCustomerUpdates.BirthDate
<br/>, CommuteDistance = stgDimCustomerUpdates.CommuteDistance
<br/>, DateFirstPurchase = stgDimCustomerUpdates.DateFirstPurchase
<br/>, EmailAddress = stgDimCustomerUpdates.EmailAddress
<br/>, EnglishEducation = stgDimCustomerUpdates.EnglishEducation
<br/>, EnglishOccupation = stgDimCustomerUpdates.EnglishOccupation
<br/>, FirstName = stgDimCustomerUpdates.FirstName
<br/>, Gender = stgDimCustomerUpdates.Gender
<br/>, GeographyKey = stgDimCustomerUpdates.GeographyKey
<br/>, HouseOwnerFlag = stgDimCustomerUpdates.HouseOwnerFlag
<br/>, LastName = stgDimCustomerUpdates.LastName
<br/>, MaritalStatus = stgDimCustomerUpdates.MaritalStatus
<br/>, MiddleName = stgDimCustomerUpdates.MiddleName
<br/>, NumberCarsOwned = stgDimCustomerUpdates.NumberCarsOwned
<br/>, NumberChildrenAtHome = stgDimCustomerUpdates.NumberChildrenAtHome
<br/>, Phone = stgDimCustomerUpdates.Phone
<br/>, Suffix = stgDimCustomerUpdates.Suffix
<br/>, Title = stgDimCustomerUpdates.Title
<br/>, TotalChildren = stgDimCustomerUpdates.TotalChildren
<br/>FROM dbo.DimCustomer DimCustomer
<br/>INNER JOIN dbo.stgDimCustomerUpdates
<br/>ON DimCustomer.CustomerAlternateKey = stgDimCustomerUpdates.CustomerAlternateKey</blockquote>
<br/>
Click OK in the Execute SQL Task Editor dialog box, and then save the package.
<br/>
<a href="082.jpg"><img class="alignnone size-medium wp-image-307" alt="08" src="082.jpg" width="300" height="255" /></a>
<br/><br/>
You have successfully created an ETL flow.
<br/><br/>
<!-- Tag Cloud start -->

<div class="container col-md-12">
<ul class="nav nav-pills pull-right" id="tagcloud"> 
<h3> <hr id="j1-hr"/> </h3>
</ul>
</div>

<div class="container col-md-12" id="tagcloud">
<ul class="nav nav-pills pull-center" id="tags"> 
<a href="tag-hadoop.html" class="tag1">Hadoop</a>
<a href="tag-msbi.html" class="tag2">MSBI</a>
<a href="tag-etl-bi.html" class="tag3">ETL & BI</a>
<a href="tag-bigdata.html" class="tag4">Bigdata</a>
<a href="tag-reviews.html" class="tag5">Reviews</a>
<a href="tag-case-study.html" class="tag6">Case Study</a>
<a href="tag-others.html" class="tag10">Others</a>
</ul>
</div>	
<!-- Tag Cloud end -->	

</div>

<!-- Jumbotron 1 end -->


</div>

<!-- Container 1 end -->

<div class="jumbotron col-md-4" id="j2">
	<h3>Also Read
	</h3>
<hr id="j2-hr"/>
<ul class="list-inline" id="j2-side"> <li> <a title="BabaGyan.com | Blog Post" href="case-study-multiply-revenue-and-customer-base.html">Case Study: Multiply Revenue as well as Customer Base</a></li><li> <a title="BabaGyan.com | Blog Post" href="tool-project-tracker.html">Tool: Project Stages Tracker</a></li><li> <a title="BabaGyan.com | Blog Post" href="exploring-cloud-on-platform-google.html">Exploring Cloud platform on Google</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="babagyan-com-exploring-ghost-blogging-platform-on-bitnami.html">BabaGyan.com Exploring Ghost Blogging platform on Bitnami</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="solutions-issues-faced-hadoop-configuration.html">Solutions for issues faced during hadoop configuration</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="hadoop-ubuntu-step-4.html">Hadoop and Ubuntu - step 4</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="hadoop-ubuntu-step-3-set-up-ssh.html">Hadoop and Ubuntu - step 3</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="hadoop-ubuntu-step-2-install-oracle-java.html">Hadoop and Ubuntu - step 2</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="hadoop-ubuntu-step-1.html">Hadoop and Ubuntu - step 1</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="usage-hadoop.html">Usage of Hadoop</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="hadoop-architecture-birdview.html">Hadoop architecture birdview</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="pros-cons-gmail-displaying-images-emails.html">Pros and Cons of Gmail displaying images in your emails</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="clt20-2013-twitter-analysis.html">CLT20 2013 Twitter Analysis</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="etl-bi-bigdata-past-and-future.html">ETL BI BigData Past Future</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="tool-daily-expense-tracker.html">Tool: Daily Expense Tracker</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ways-create-website.html">Lifesaver: Ways to create a website</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-business-intelligence-projects.html">LifeSaver: Business Intelligence Projects - Success and Failures</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-differences-between-udt-and-idt.html">LifeSaver: Differences between UDT and IDT</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="data-quality-in-etl-and-bi.html">Data Quality in ETL and BI</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="problem-solving-methodology.html">Problem Solving Methodology</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="what-is-mentoring.html">What is Mentoring</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="qlikview-advantage.html">QlikView advantage over query based BI</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="types-data.html">Types of data</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lyrics-one-two-three-four-chennai-express.html">Lyrics One Two Three Four Chennai Express</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="qlikview-licensing-an-overview.html">QlikView Licensing - an Overview</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="baba-jee-ki-booti.html">Theme song lyrics - Baba jee ki booti</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="tv-oled-led-lcd-plasma.html">TV - OLED vs LED vs LCD vs Plasma</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="review-google-moto-x.html">Review Google Moto X</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="blackberry-q10-q5-review.html">Review: Blackberry Q10 and Blackberry Q5</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-ssrs-all-in-one.html">Lifesaver - SSRS All in one</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-ssis-all-in-one.html">Lifesaver - SSIS All in one</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-ssas-mdx-quick-fixes.html">Lifesaver - SSAS MDX Quick fixes</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-ssrs-quick-fixes.html">Lifesaver - SSRS Quick fixes</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-variables-script-profiling.html">SSIS Package Variables, Script and Profiling</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="lifesaver-ssis-quick-fixes.html">Lifesaver - SSIS Quick fixes</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-control-flow-containers.html">SSIS Control Flow Containers</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-control-flow-objects.html">SSIS Control Flow Objects</a>
</li><li class="active"> <a title="BabaGyan.com | Blog Post" href="ssis-exercise-05.html">SSIS Exercise 05</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-exercise-04.html">SSIS Exercise 04</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-exercise-03.html">SSIS Exercise 03</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-exercise-02.html">SSIS Exercise 02</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="ssis-exercise-01.html">SSIS Exercise 01</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="theme-song-lyrics-the-big-bang-theory.html">Theme song lyrics - The Big Bang Theory</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="theme-song-lyrics-friends.html">Theme song lyrics - F.R.I.E.N.D.S</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="sql-aggregate-analytic-functions.html">SQL - Aggregate & Analytic functions</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="list-of-analytical-functions.html">SQL - List of Analytical functions</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="sql-statement.html">SQL - Where, Operators and alias</a>
</li><li> <a title="BabaGyan.com | Blog Post" href="sql-structured-query-language-for-database-quering.html">SQL - Structured Query Language for Database quering</a>
</li>
</ul>
</div>
 
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster 	-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
   <script src="../js/babagyan.js"></script>  <script> trackReferrer(); </script>  </body>
</html>
